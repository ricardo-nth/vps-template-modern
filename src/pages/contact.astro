---
import SiteLayout from '@layouts/SiteLayout.astro';
import { getEntry } from 'astro:content';
import PageHero from '@components/PageHero.astro';
import ContactOptions from '@components/ContactOptions.astro';
import OfficeLocation from '@components/OfficeLocation.astro';
import FeedbackSection from '@components/FeedbackSection.astro';

const contactEntry = await getEntry('modernContact', 'default');
const contactDomEntry = await getEntry('modernContact', 'dom-care');
if (!contactEntry) {
  throw new Error('Missing content entry: modernContact/default');
}
if (!contactDomEntry) {
  throw new Error('Missing content entry: modernContact/dom-care');
}

const metadata = contactEntry.data.metadata;
const profiles = [
  { key: 'supported-living', content: contactEntry.data },
  { key: 'dom-care', content: contactDomEntry.data },
] as const;
---

<SiteLayout metadata={metadata}>
  <div data-care-profile-switcher>
    {profiles.map(({ key, content }) => (
      <div data-care-profile-panel={key} class:list={{ hidden: key !== 'supported-living' }}>
        <PageHero
          heading={content.hero.heading}
          subheading={content.hero.subheading}
          primaryCtaText={content.hero.primaryCtaText}
          primaryCtaHref={content.hero.primaryCtaHref}
          secondaryCtaText={content.hero.secondaryCtaText}
          secondaryCtaHref={content.hero.secondaryCtaHref}
        >
          <div slot="visual" class="bg-white/10 backdrop-blur-md border border-white/20 rounded-3xl p-8">
            <h3 class="text-2xl font-bold text-white mb-6">{content.hero.quickContactHeading}</h3>
            <ContactOptions options={content.quickContactOptions} variant="hero" />
          </div>
        </PageHero>

        <section class="py-24 bg-background">
          <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="text-center max-w-3xl mx-auto mb-16">
              <h2 class="text-3xl sm:text-4xl font-bold text-foreground mb-6">{content.contactOptionsSection.heading}</h2>
              <p class="text-lg text-muted-foreground">
                {content.contactOptionsSection.intro}
              </p>
            </div>
            <ContactOptions options={content.gridContactOptions} variant="grid" />
          </div>
        </section>

        <OfficeLocation
          badgeLabel={content.officeLocation.badgeLabel}
          heading={content.officeLocation.heading}
          intro={content.officeLocation.intro}
          officeLabel={content.officeLocation.officeLabel}
          address={content.officeLocation.address}
          mapUrl={content.officeLocation.mapUrl}
          directionsUrl={content.officeLocation.directionsUrl}
          directionsText={content.officeLocation.directionsText}
        />

        <FeedbackSection
          heading={content.feedbackSection.heading}
          intro={content.feedbackSection.intro}
          compliment={content.feedbackSection.compliment}
          complaint={content.feedbackSection.complaint}
          cqcNote={content.feedbackSection.cqcNote}
          cqcLinkText={content.feedbackSection.cqcLinkText}
          cqcLinkHref={content.feedbackSection.cqcLinkHref}
        />
      </div>
    ))}
  </div>
</SiteLayout>
